CREATE TABLE IF NOT EXISTS USERS
(
    EMAIL VARCHAR(100) UNIQUE NOT NULL,
    ID    BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NAME  VARCHAR(100)
);

CREATE TABLE IF NOT EXISTS CATEGORIES
(
    ID   BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NAME VARCHAR(255) UNIQUE NOT NULL
);

CREATE TABLE IF NOT EXISTS EVENTS
(
    ANNOTATION         VARCHAR(2000) NOT NULL,
    CATEGORY_ID        BIGINT        NOT NULL REFERENCES CATEGORIES (ID),
    CONFIRMED_REQUESTS BIGINT,
    CREATED_ON         TIMESTAMP,
    DESCRIPTION        VARCHAR(7000),
    EVENT_DATE         TIMESTAMP     NOT NULL,
    LOCATION_LAT       FLOAT,
    LOCATION_LON       FLOAT,
    ID                 BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    INITIATOR_ID       BIGINT        NOT NULL REFERENCES USERS (ID),
    PAID               BOOLEAN,
    PARTICIPANT_LIMIT  INTEGER,
    PUBLISHED_ON       TIMESTAMP,
    REQUEST_MODERATION BOOLEAN,
    STATE              VARCHAR(20),
    TITLE              VARCHAR(120)  NOT NULL,
    VIEWS              BIGINT

);

CREATE TABLE IF NOT EXISTS REQUESTS
(
    CREATED      TIMESTAMP DEFAULT current_timestamp,
    EVENT_ID     BIGINT REFERENCES EVENTS (ID),
    ID           BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    REQUESTER_ID BIGINT REFERENCES USERS (ID),
    STATUS       VARCHAR(50)
);

CREATE TABLE IF NOT EXISTS COMPILATIONS
(
    EVENT_ID BIGINT REFERENCES EVENTS (ID),
    ID       BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    PINNED   BOOLEAN,
    TITLE    VARCHAR NOT NULL
);

CREATE TABLE IF NOT EXISTS EVENTS_COMPILATIONS
(
    EVENT_ID       BIGINT REFERENCES EVENTS,
    COMPILATION_ID BIGINT REFERENCES COMPILATIONS,
    PRIMARY KEY (EVENT_ID, COMPILATION_ID)
);